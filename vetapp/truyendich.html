<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng c·ª• t√≠nh to√°n d·ªãch truy·ªÅn cho ch√≥/m√®o</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 25px;
        }
        .section-header {
            font-size: 1.5em;
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        .input-group input:focus, .input-group select:focus {
            border-color: #007bff;
            outline: none;
        }
        .input-group .note {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            display: block;
        }
        .result-group {
            margin-top: 15px;
        }
        .result-group label {
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }
        .result-group input {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1em;
            cursor: default;
        }
        .divider {
            margin: 25px 0;
            border-top: 1px dashed #000661;
        }
        .centered-label {
            text-align: center;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .flex-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .flex-item {
            flex: 1;
            min-width: 250px;
        }
        .button-group button {
            flex: 1;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .button-group button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>C√¥ng c·ª• t√≠nh to√°n d·ªãch truy·ªÅn cho ch√≥/m√®o üê∂üê±</h1>

    <div class="section-header">1. KHAI B√ÅO</div>
    <div class="input-group">
        <label for="weight">Tr·ªçng l∆∞·ª£ng (kg):</label>
        <input type="number" id="weight" step="0.1" placeholder="V√≠ d·ª•: 5.5">
    </div>
    <div class="input-group">
        <label for="body-mass">Ch·ªâ s·ªë c∆° th·ªÉ:</label>
        <select id="body-mass">
            <option value="normal">B√¨nh th∆∞·ªùng</option>
            <option value="fat">B√©o</option>
        </select>
    </div>
    <div class="input-group">
        <label for="dehydration-percent">Ph·∫ßn trƒÉm m·∫•t n∆∞·ªõc (%):</label>
        <select id="dehydration-percent">
            <option value="5">5% (bt)</option>
            <option value="6">6%</option>
            <option value="9">9%</option>
            <option value="12">12%</option>
            <option value="15">15%</option>
        </select>
    </div>
    <div class="input-group">
        <label for="resp-fluid-loss">Th·ªÉ t√≠ch m·∫•t n∆∞·ªõc h√¥ h·∫•p (ml):</label>
        <span class="note">G·ªçi t·∫Øt l√† V h√¥ h·∫•p. C√¥ng th·ª©c = s·ªë gi·ªù x 7 x tr·ªçng l∆∞·ª£ng</span>
        <input type="number" id="resp-fluid-loss" placeholder="Nh·∫≠p gi√° tr·ªã ho·∫∑c ƒë·ªÉ 0">
    </div>
    <div class="input-group">
        <label for="digestive-fluid-loss">Th·ªÉ t√≠ch m·∫•t n∆∞·ªõc ti√™u h√≥a (ml):</label>
        <span class="note">G·ªçi t·∫Øt l√† V ti√™u h√≥a. ƒê·ªãnh l∆∞·ª£ng b·∫±ng c·ªëc ƒëong.</span>
        <input type="number" id="digestive-fluid-loss" placeholder="Nh·∫≠p gi√° tr·ªã ho·∫∑c ƒë·ªÉ 0">
    </div>

    <div class="divider"></div>

    <div class="section-header">2. KHI B·ªÜNH TH√ö M·ªöI ƒê·∫æN</div>
    <button onclick="calculateArrivalFluid()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">T√≠nh to√°n</button>

    <div class="result-group">
        <label for="arrival-volume-12h">Th·ªÉ t√≠ch d·ªãch truy·ªÅn trong 12H (ml):</label>
        <span class="note">= % m·∫•t n∆∞·ªõc x "c√¢n n·∫∑ng" x 10</span>
        <input type="text" id="arrival-volume-12h" readonly>
    </div>

    <p class="centered-label">Chia ra:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-gluco-30">V Gluco 30% (ml):</label>
                <input type="text" id="arrival-v-gluco-30" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-other-30">=> Th·ªÉ t√≠ch c√°c lo·∫°i d·ªãch kh√°c (ml):</label>
                <input type="text" id="arrival-v-other-30" readonly>
            </div>
        </div>
    </div>

    <p class="centered-label">Ho·∫∑c:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-gluco-5">V Gluco 5% (ml):</label>
                <input type="text" id="arrival-v-gluco-5" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-other-5">=> Th·ªÉ t√≠ch c√°c lo·∫°i d·ªãch kh√°c (ml):</label>
                <input type="text" id="arrival-v-other-5" readonly>
            </div>
        </div>
    </div>
    
    <div class="divider"></div>

    <div class="section-header">3. KHI B·ªÜNH TH√ö N·∫∞M VI·ªÜN</div>
    <button onclick="calculateHospitalFluid()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">T√≠nh to√°n</button>
    <div class="result-group">
        <label for="hospital-volume-24h">T·ªïng th·ªÉ t√≠ch d·ªãch truy·ªÅn trong 1 ng√†y (ml):</label>
        <span class="note">= 97 x "c√¢n n·∫∑ng tr·ª´ m·ª°" l≈©y th·ª´a 0.655 + V h√¥ h·∫•p + V ti√™u h√≥a</span>
        <input type="text" id="hospital-volume-24h" readonly>
    </div>

    <p class="centered-label">Chia ra:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-gluco-30">V Gluco 30% (ml):</label>
                <input type="text" id="hospital-v-gluco-30" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-other-30">=> Th·ªÉ t√≠ch c√°c lo·∫°i d·ªãch kh√°c (ml):</label>
                <input type="text" id="hospital-v-other-30" readonly>
            </div>
        </div>
    </div>

    <p class="centered-label">Ho·∫∑c:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-gluco-5">V Gluco 5% (ml):</label>
                <input type="text" id="hospital-v-gluco-5" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-other-5">=> Th·ªÉ t√≠ch c√°c lo·∫°i d·ªãch kh√°c (ml):</label>
                <input type="text" id="hospital-v-other-5" readonly>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section-header">4. T·ªêC ƒê·ªò & TH·ªúI GIAN TRUY·ªÄN D·ªäCH</div>
    <div class="input-group">
        <label for="drip-factor">Th√¥ng s·ªë d√¢y:</label>
        <span class="note">Xem tr√™n bao b√¨ nh√† s·∫£n xu·∫•t ghi bao nhi√™u gi·ªçt/1ml ?</span>
        <select id="drip-factor">
            <option value="20">20</option>
            <option value="15">15</option>
        </select>
    </div>
    <div class="input-group">
        <label for="drip-rate">T·ªëc ƒë·ªô nh·ªè gi·ªçt ƒë·∫øm ƒë∆∞·ª£c:</label>
        <span class="note">BSTY s·∫Ω quan s√°t th·ª±c t·∫ø xem trong 1 ph√∫t c√≥ bao nhi√™u gi·ªçt nh·ªè xu·ªëng ?</span>
        <input type="number" id="drip-rate" placeholder="v√≠ d·ª•: 30 gi·ªçt/ph√∫t">
    </div>
    <div class="input-group">
        <label for="volume-to-infuse">Th·ªÉ t√≠ch mu·ªën truy·ªÅn (ml):</label>
        <span class="note">BSTY ph·∫£i nh·∫≠p th·ªÉ t√≠ch ƒë√£ t√≠nh to√°n ·ªü c√°c ph·∫ßn tr√™n v√†o ƒë√¢y</span>
        <input type="number" id="volume-to-infuse" placeholder="v√≠ d·ª•: 500">
    </div>
    <div class="input-group">
        <label for="start-time">Gi·ªù b·∫Øt ƒë·∫ßu truy·ªÅn:</label>
        <input type="text" id="start-time" placeholder="nh·∫≠p theo ƒë·ªãnh d·∫°ng 13:33">
    </div>

    <button onclick="calculateInfusion()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">T√≠nh to√°n</button>

    <div class="result-group">
        <label for="infusion-time">=> Th·ªùi gian c·∫ßn truy·ªÅn d·ª± ki·∫øn:</label>
        <input type="text" id="infusion-time" readonly>
    </div>

    <div class="result-group">
        <label for="end-time">=> S·∫Ω k·∫øt th√∫c truy·ªÅn l√∫c:</label>
        <input type="text" id="end-time" readonly>
    </div>

    <div class="divider"></div>

    <div class="section-header">5. ∆Ø·ªöC L∆Ø·ª¢NG</div>
    <button onclick="calculateEstimation()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">∆Ø·ªõc l∆∞·ª£ng</button>
    <div class="input-group">
        <label for="start-time-estimation">Th·ªùi gian b·∫Øt ƒë·∫ßu truy·ªÅn:</label>
        <span class="note">T·ª± ƒë·ªông l·∫•y t·ª´ √¥ "Gi·ªù b·∫Øt ƒë·∫ßu truy·ªÅn" ·ªü khung "4. T·ªêC ƒê·ªò & TH·ªúI GIAN TRUY·ªÄN D·ªäCH"</span>
        <input type="text" id="start-time-estimation" readonly>

    </div>
    <div class="result-group">
        <label for="estimated-minutes">∆Ø·ªõc l∆∞·ª£ng th·ªùi gian ƒë√£ tr√¥i qua:</label>
        <span class="note">T·ª± ƒë·ªông l·∫•y gi·ªù t·∫°i th·ªùi ƒëi·ªÉm nh·∫•n n√∫t "∆Ø·ªõc l∆∞·ª£ng" tr·ª´ cho gi·ªù trong √¥ "Th·ªùi gian b·∫Øt ƒë·∫ßu truy·ªÅn"</span>
        <input type="text" id="estimated-minutes" readonly>
    </div>
    <div class="result-group">
        <label for="estimated-volume">∆Ø·ªõc l∆∞·ª£ng t·ªïng th·ªÉ t√≠ch ƒë√£ truy·ªÅn (ml):</label>
        <input type="text" id="estimated-volume" readonly>
    </div>
</div>

<script>
    function calculateArrivalFluid() {
        const weight = parseFloat(document.getElementById('weight').value);
        const dehydrationPercent = parseFloat(document.getElementById('dehydration-percent').value);
        const bodyMass = document.getElementById('body-mass').value;

        if (isNaN(weight) || weight <= 0) {
            alert('Vui l√≤ng nh·∫≠p Tr·ªçng l∆∞·ª£ng h·ª£p l·ªá.');
            return;
        }

        let volume12h;
        if (bodyMass === 'normal') {
            volume12h = weight * dehydrationPercent * 10;
        } else { // 'fat'
            volume12h = weight * 0.7 * dehydrationPercent * 10;
        }
        
        let vGluco30;
        if (bodyMass === 'normal') {
            vGluco30 = (97 * Math.pow(weight, 0.655) * 0.1) / 2;
        } else { // 'fat'
            vGluco30 = (97 * Math.pow(weight * 0.7, 0.655) * 0.1) / 2;
        }
        
        const vOther30 = volume12h - vGluco30;

        const vGluco5 = vGluco30 * 6;
        const vOther5 = volume12h - vGluco5;

        document.getElementById('arrival-volume-12h').value = `${volume12h.toFixed(2)} ml`;
        document.getElementById('arrival-v-gluco-30').value = `${vGluco30.toFixed(2)} ml`;
        document.getElementById('arrival-v-other-30').value = `${vOther30.toFixed(2)} ml`;
        document.getElementById('arrival-v-gluco-5').value = `${vGluco5.toFixed(2)} ml`;
        document.getElementById('arrival-v-other-5').value = `${vOther5.toFixed(2)} ml`;
    }

    function calculateHospitalFluid() {
        const weight = parseFloat(document.getElementById('weight').value);
        const respFluidLoss = parseFloat(document.getElementById('resp-fluid-loss').value) || 0;
        const digestiveFluidLoss = parseFloat(document.getElementById('digestive-fluid-loss').value) || 0;
        const bodyMass = document.getElementById('body-mass').value;
        
        if (isNaN(weight) || weight <= 0) {
            alert('Vui l√≤ng nh·∫≠p Tr·ªçng l∆∞·ª£ng h·ª£p l·ªá.');
            return;
        }

        let bodyWeightForCalculation;
        if (bodyMass === 'normal') {
            bodyWeightForCalculation = weight;
        } else { // 'fat'
            bodyWeightForCalculation = weight * 0.7;
        }

        const totalHospitalFluid = (97 * Math.pow(bodyWeightForCalculation, 0.655)) + respFluidLoss + digestiveFluidLoss;
        
        const vGluco30Arrival = parseFloat(document.getElementById('arrival-v-gluco-30').value);
        if (isNaN(vGluco30Arrival)) {
            alert('Vui l√≤ng t√≠nh to√°n khung "KHI B·ªÜNH TH√ö M·ªöI ƒê·∫æN" tr∆∞·ªõc ƒë·ªÉ c√≥ gi√° tr·ªã V Gluco 30% (ml).');
            return;
        }

        const vGluco30Hospital = vGluco30Arrival * 2;
        const vOther30Hospital = totalHospitalFluid - vGluco30Hospital;

        const vGluco5Hospital = vGluco30Hospital * 6;
        const vOther5Hospital = totalHospitalFluid - vGluco5Hospital;

        document.getElementById('hospital-volume-24h').value = `${totalHospitalFluid.toFixed(2)} ml`;
        document.getElementById('hospital-v-gluco-30').value = `${vGluco30Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-other-30').value = `${vOther30Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-gluco-5').value = `${vGluco5Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-other-5').value = `${vOther5Hospital.toFixed(2)} ml`;
    }

    function calculateInfusion() {
        const dripFactor = parseFloat(document.getElementById('drip-factor').value);
        const dripRate = parseFloat(document.getElementById('drip-rate').value);
        const volumeToInfuse = parseFloat(document.getElementById('volume-to-infuse').value);
        const startTimeStr = document.getElementById('start-time').value;

        if (isNaN(dripRate) || isNaN(volumeToInfuse) || dripRate <= 0 || volumeToInfuse <= 0) {
            alert('Vui l√≤ng nh·∫≠p c√°c gi√° tr·ªã T·ªëc ƒë·ªô nh·ªè gi·ªçt v√† Th·ªÉ t√≠ch mu·ªën truy·ªÅn h·ª£p l·ªá.');
            return;
        }

        const infusionTimeMinutes = (volumeToInfuse * dripFactor) / dripRate;
        
        const hours = Math.floor(infusionTimeMinutes / 60);
        const minutes = Math.round(infusionTimeMinutes % 60);
        document.getElementById('infusion-time').value = `${hours} gi·ªù ${minutes} ph√∫t`;

        if (startTimeStr) {
            const timeParts = startTimeStr.split(':');
            const startHour = parseInt(timeParts[0]);
            const startMinute = parseInt(timeParts[1]);

            if (isNaN(startHour) || isNaN(startMinute) || startHour < 0 || startHour > 23 || startMinute < 0 || startMinute > 59) {
                alert('ƒê·ªãnh d·∫°ng gi·ªù b·∫Øt ƒë·∫ßu truy·ªÅn kh√¥ng h·ª£p l·ªá. Vui l√≤ng nh·∫≠p theo ƒë·ªãnh d·∫°ng HH:MM.');
                document.getElementById('end-time').value = '';
                return;
            }

            const totalMinutes = startHour * 60 + startMinute + infusionTimeMinutes;
            const endHour = Math.floor((totalMinutes / 60) % 24);
            const endMinute = Math.round(totalMinutes % 60);
            
            const endHourStr = endHour.toString().padStart(2, '0');
            const endMinuteStr = endMinute.toString().padStart(2, '0');

            document.getElementById('end-time').value = `${endHourStr}:${endMinuteStr}`;
        }
        
        document.getElementById('start-time-estimation').value = startTimeStr;
    }

    function calculateEstimation() {
        const dripFactor = parseFloat(document.getElementById('drip-factor').value);
        const dripRate = parseFloat(document.getElementById('drip-rate').value);
        const startTimeStr = document.getElementById('start-time').value;
        
        if (!startTimeStr || isNaN(dripRate) || dripRate <= 0) {
            alert('Vui l√≤ng nh·∫≠p "Gi·ªù b·∫Øt ƒë·∫ßu truy·ªÅn:" v√† "T·ªëc ƒë·ªô nh·ªè gi·ªçt" h·ª£p l·ªá.');
            return;
        }

        const timeParts = startTimeStr.split(':');
        const startHour = parseInt(timeParts[0]);
        const startMinute = parseInt(timeParts[1]);
        
        const now = new Date();
        const currentHour = now.getHours();
        const currentMinute = now.getMinutes();

        const startTotalMinutes = startHour * 60 + startMinute;
        const currentTotalMinutes = currentHour * 60 + currentMinute;
        
        const passedTimeMinutes = currentTotalMinutes - startTotalMinutes;

        if (passedTimeMinutes < 0) {
            alert('Th·ªùi gian b·∫Øt ƒë·∫ßu truy·ªÅn l·ªõn h∆°n th·ªùi gian hi·ªán t·∫°i. Vui l√≤ng ki·ªÉm tra l·∫°i.');
            document.getElementById('estimated-minutes').value = '';
            document.getElementById('estimated-volume').value = '';
            return;
        }

        const hours = Math.floor(passedTimeMinutes / 60);
        const minutes = passedTimeMinutes % 60;
        
        const estimatedVolume = (dripRate * passedTimeMinutes) / dripFactor;
        
        document.getElementById('estimated-minutes').value = `${hours} gi·ªù ${minutes} ph√∫t`;
        document.getElementById('estimated-volume').value = `${estimatedVolume.toFixed(2)} ml`;
    }
</script>

</body>
</html>