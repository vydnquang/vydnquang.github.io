<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tính lượng dịch truyền - Phần mềm dành cho bác sĩ thú y</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #e0f2f7;
            color: ;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            line-height: 1.6;
        }
        main {
            flex-grow: 1;
        }

main .container {
            max-width: 800px;
            margin: auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

.container h1 {
            text-align: center;
            color: #007bff;
            margin-bottom: 25px;
font-size: 2.2rem;
        }

        .section-header {
            font-size: 1.5em;
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-top: 25px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        .input-group input:focus, .input-group select:focus {
            border-color: #007bff;
            outline: none;
        }
        .input-with-button {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .input-with-button input {
            flex-grow: 1;
        }
        .input-with-button button {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
        }
        .input-with-button button:hover {
            background-color: #0056b3;
        }
        .input-group .note {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            margin-bottom: 0px; /* đặt khoảng cách lề dưới của dòng chú thích ô nhập liệu */
            display: block;

        }
        .note.highlight {
           color: blue;
           text-align: center;
           margin-bottom: 2px; /* đặt khoảng cách lề dưới của dòng chú thích tiêu đề */
           display: block;
        }
        .result-group {
            margin-top: 15px;
        }
        .result-group label {
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }
        .result-group input {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1em;
            cursor: default;
        }
        .result-group .note {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 5px;
            margin-bottom: 0px; /* đặt khoảng cách lề dưới của dòng chú thích ô kết quả */
            display: block;
        }
        .divider {
            margin: 25px 0;
            border-top: 1px dashed #000661;
        }
        .centered-label {
            text-align: center;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .flex-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .flex-item {
            flex: 1;
            min-width: 250px;
        }
        .button-group button {
            flex: 1;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .button-group button:hover {
            background-color: #0056b3;
        }
        .drip-counter-display {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            color: #dc3545;
        }

#footer-placeholder {
    background-color: #facc15; /* Hoặc thay bằng màu bạn muốn */
}
.modal-content-scrollable {
    max-height: 80vh; /* Chiều cao tối đa 80% chiều cao màn hình */
    overflow-y: auto; /* Tự động cuộn theo chiều dọc */
}

    </style>
</head>
<body>
    <div id="header-placeholder"></div>


    <main class="max-w-4xl mx-auto p-4">

      <div class="container">
    <h1>Công cụ tính Thể tích dịch truyền cho Chó/Mèo</h1>

    <div class="section-header">1. KHAI BÁO</div>
    <div class="input-group">
        <label for="weight">Trọng lượng (kg):</label>
        <input type="number" id="weight" step="0.1" placeholder="Ví dụ: 5.5">
    </div>
    <div class="input-group">
        <label for="body-mass">Chỉ số cơ thể:</label>
        <select id="body-mass">
            <option value="normal">Bình thường</option>
            <option value="fat">Béo</option>
        </select>
    </div>
    <div class="input-group">
        <label for="dehydration-percent">Phần trăm mất nước (%):</label>
        <select id="dehydration-percent">
            <option value="5">5% (bình thường)</option>
            <option value="6">6%</option>
            <option value="9">9%</option>
            <option value="12">12%</option>
            <option value="15">15%</option>
        </select>
    </div>
    <div class="input-group">
        <label for="resp-fluid-loss">Thể tích mất nước hô hấp (ml):</label>
        <span class="note">Gọi tắt là V hô hấp. Công thức = số giờ x 7 x trọng lượng</span>
        <input type="number" id="resp-fluid-loss" placeholder="Nhập giá trị hoặc để 0">
    </div>
    <div class="input-group">
        <label for="digestive-fluid-loss">Thể tích mất nước tiêu hóa (ml):</label>
        <span class="note">Gọi tắt là V tiêu hóa. Định lượng bằng cốc đong.</span>
        <input type="number" id="digestive-fluid-loss" placeholder="Nhập giá trị hoặc để 0">
    </div>

    <div class="divider"></div>

    <div class="section-header">2. KHI BỆNH THÚ MỚI ĐẾN</div>
    <button onclick="calculateArrivalFluid()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Tính toán</button>

    <div class="result-group">
        <label for="arrival-volume-12h">Thể tích dịch truyền trong 12H (ml):</label>
        <span class="note">= % mất nước x "cân nặng trừ mỡ" x 10</span>
        <input type="text" id="arrival-volume-12h" readonly>
    </div>

    <p class="centered-label">Chia ra:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-gluco-30">V Gluco 30% (ml):</label>
                <input type="text" id="arrival-v-gluco-30" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-other-30">=> Thể tích các loại dịch khác (ml):</label>
                <input type="text" id="arrival-v-other-30" readonly>
            </div>
        </div>
    </div>

    <p class="centered-label">Hoặc:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-gluco-5">V Gluco 5% (ml):</label>
                <input type="text" id="arrival-v-gluco-5" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="arrival-v-other-5">=> Thể tích các loại dịch khác (ml):</label>
                <input type="text" id="arrival-v-other-5" readonly>
            </div>
        </div>
    </div>
    
    <div class="divider"></div>

    <div class="section-header">3. KHI BỆNH THÚ NẰM VIỆN</div>
        <span class="note highlight">Bước này sẽ bắt đầu khi BSTY đã hoàn thành việc truyền đủ nước cho bệnh thú ở bước trên, có nghĩa là "Phần trăm mất nước" đã về mức Bình thường. Nếu tình trạng mất nước chưa được cải thiện, BSTY vẫn phải truyền theo liều lượng ở bước 2.</span>
        <br>
    <button onclick="calculateHospitalFluid()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Tính toán</button>
    <div class="result-group">
        <label for="hospital-volume-24h">Tổng thể tích dịch truyền trong 1 ngày (ml):</label>
        <span class="note">= 97 x ("cân nặng trừ mỡ" lũy thừa 0.655) + V hô hấp + V tiêu hóa</span>
        <input type="text" id="hospital-volume-24h" readonly>
    </div>

    <p class="centered-label">Chia ra:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-gluco-30">V Gluco 30% (ml):</label>
                <input type="text" id="hospital-v-gluco-30" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-other-30">=> Thể tích các loại dịch khác (ml):</label>
                <input type="text" id="hospital-v-other-30" readonly>
            </div>
        </div>
    </div>

    <p class="centered-label">Hoặc:</p>
    <div class="flex-container">
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-gluco-5">V Gluco 5% (ml):</label>
                <input type="text" id="hospital-v-gluco-5" readonly>
            </div>
        </div>
        <div class="flex-item">
            <div class="result-group">
                <label for="hospital-v-other-5">=> Thể tích các loại dịch khác (ml):</label>
                <input type="text" id="hospital-v-other-5" readonly>
            </div>
        </div>
    </div>

    <div class="divider"></div>

    <div class="section-header">4. THỜI GIAN TRUYỀN DỰA VÀO TỐC ĐỘ NHỎ GIỌT</div>
    <div class="input-group">
        <label for="drip-factor">Thông số dây:</label>
        <span class="note">Xem trên bao bì nhà sản xuất ghi bao nhiêu giọt/1ml ?</span>
        <select id="drip-factor">
            <option value="20">20</option>
            <option value="15">15</option>
        </select>
    </div>
    <div class="input-group">
        <label for="drip-rate">Tốc độ nhỏ giọt đếm được:</label>
        <span class="note">BSTY sẽ quan sát thực tế xem trong 1 phút có bao nhiêu giọt nhỏ xuống ?</span>
        <input type="number" id="drip-rate" placeholder="ví dụ: 30 giọt/phút">
    </div>
    <div class="input-group">
        <label for="volume-to-infuse">Thể tích muốn truyền (ml):</label>
        <span class="note">BSTY phải nhập thể tích đã tính toán ở các phần trên vào đây</span>
        <input type="number" id="volume-to-infuse" placeholder="ví dụ: 500">
    </div>
    <div class="input-group">
        <label for="start-time">Giờ bắt đầu truyền:</label>
        <div class="input-with-button">
            <input type="text" id="start-time" placeholder="nhập theo định dạng 13:33">
            <button onclick="getCurrentTime()">Lấy giờ</button>
        </div>
    </div>

    <button onclick="calculateInfusion()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Tính toán</button>

    <div class="result-group">
        <label for="infusion-time">=> Thời gian cần truyền dự kiến:</label>
        <input type="text" id="infusion-time" readonly>
    </div>

    <div class="result-group">
        <label for="end-time">=> Sẽ kết thúc truyền lúc:</label>
        <input type="text" id="end-time" readonly>
    </div>

    <div class="divider"></div>

    <div class="section-header">5. ƯỚC LƯỢNG</div>
        <span class="note highlight">Công cụ này giúp BSTY ước lượng 1 cách tương đối lượng dịch đã được truyền vào cơ thể bệnh thú, vì bỏ qua các vấn đề có thể làm sai lệch kết quả do thú bệnh gây ra như: xoắn/gập ống truyền dịch, con thú gập chân dẫn đến ven không thông hoặc các vấn đề gây rò rỉ dịch truyền...</span>
        <br>
    <button onclick="calculateEstimation()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Ước lượng</button>
    <div class="input-group">
        <label for="start-time-estimation">Thời gian bắt đầu truyền:</label>
        <span class="note">Tự động lấy từ ô "Giờ bắt đầu truyền" ở khung "4. THỜI GIAN TRUYỀN DỰA VÀO TỐC ĐỘ NHỎ GIỌT"</span>
        <input type="text" id="start-time-estimation" readonly>

    </div>
    <div class="result-group">
        <label for="estimated-minutes">Ước lượng thời gian đã trôi qua:</label>
        <span class="note">Tự động lấy giờ tại thời điểm nhấn nút "Ước lượng" trừ cho giờ trong ô "Thời gian bắt đầu truyền"</span>
        <input type="text" id="estimated-minutes" readonly>
    </div>
    <div class="result-group">
        <label for="estimated-volume">Ước lượng tổng thể tích đã truyền (ml):</label>
        <input type="text" id="estimated-volume" readonly>
    </div>

<div class="divider"></div>

    <div class="section-header">6. CÔNG CỤ TÍNH TỐC ĐỘ NHỎ GIỌT</div>
        <span class="note highlight">Công cụ này giúp BSTY có được thông số tốc độ nhỏ giọt trung bình, mà không cần phải quan sát trong 1 phút có bao nhiêu giọt nhỏ xuống. Công cụ này dựa trên việc cứ thấy 1 giọt nhỏ xuống thì bấm vào nút "Đếm giọt" 1 lần, nó sẽ dựa vào thời gian đã trôi qua để suy ra tốc độ.</span>
    <br>
    <div class="flex-container">
        <div class="flex-item">
            <button onclick="startStopTimer()" id="timer-button" style="width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Bắt đầu</button>
        </div>
        <div class="flex-item">
            <button onclick="countDrop()" id="count-button" disabled style="width: 100%; padding: 12px; background-color: #6c757d; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: not-allowed;">Đếm giọt</button>
        </div>
        <div class="flex-item">
            <button onclick="resetTimer()" id="reset-button" style="width: 100%; padding: 12px; background-color: #dc3545; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Đặt lại</button>
        </div>
    </div>
    
    <div class="result-group">
        <label>Thời gian đã trôi qua:</label>
        <div id="elapsed-time" class="drip-counter-display">00:00</div>
    </div>
    <div class="result-group">
        <label>Tổng số giọt đã đếm:</label>
        <div id="drip-count" class="drip-counter-display">0</div>
    </div>
    <div class="result-group">
        <label>=> Tốc độ nhỏ giọt (giọt/phút):</label>
        <input type="text" id="calculated-drip-rate" readonly>
    </div>

    <div class="divider"></div>

    <div class="section-header">7. CÔNG CỤ TÍNH TỐC ĐỘ NHỎ GIỌT THEO THỜI GIAN</div>
        <span class="note highlight">Công cụ này giúp BSTY tính ra tốc độ nhỏ giọt là bao nhiêu để truyền hết một thể tích cần thiết trong một khoảng thời gian mong muốn.</span>
    <br>
    <div class="input-group">
        <label for="volume-predetermined">Thể tích muốn truyền (ml):</label>
        <input type="number" id="volume-predetermined" placeholder="ví dụ: 500">
    </div>
    <div class="input-group">
        <label for="time-predetermined">Thời gian truyền dự kiến (phút):</label>
        <input type="number" id="time-predetermined" placeholder="ví dụ: 60">
    </div>
    <div class="input-group">
        <label for="drip-factor-predetermined">Thông số dây:</label>
        <span class="note">Xem trên bao bì nhà sản xuất ghi bao nhiêu giọt/1ml ?</span>
        <select id="drip-factor-predetermined">
            <option value="20">20</option>
            <option value="15">15</option>
        </select>
    </div>
    <button onclick="calculatePredeterminedDripRate()" style="width: 100%; padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-size: 1.1em; cursor: pointer;">Tính toán</button>
    <div class="result-group">
        <label for="result-drip-rate">=> Tốc độ nhỏ giọt cần thiết (giọt/phút):</label>
        <input type="text" id="result-drip-rate" readonly>
    </div>

</div>

<script>
    function getCurrentTime() {
        const now = new Date();
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        document.getElementById('start-time').value = `${hours}:${minutes}`;
    }

    function calculateArrivalFluid() {
        const weight = parseFloat(document.getElementById('weight').value);
        const dehydrationPercent = parseFloat(document.getElementById('dehydration-percent').value);
        const bodyMass = document.getElementById('body-mass').value;

        if (isNaN(weight) || weight <= 0) {
            alert('Vui lòng nhập Trọng lượng hợp lệ.');
            return;
        }

        let volume12h;
        if (bodyMass === 'normal') {
            volume12h = weight * dehydrationPercent * 10;
        } else { // 'fat'
            volume12h = weight * 0.7 * dehydrationPercent * 10;
        }
        
        let vGluco30;
        if (bodyMass === 'normal') {
            vGluco30 = (97 * Math.pow(weight, 0.655) * 0.1) / 2;
        } else { // 'fat'
            vGluco30 = (97 * Math.pow(weight * 0.7, 0.655) * 0.1) / 2;
        }
        
        const vOther30 = volume12h - vGluco30;

        const vGluco5 = vGluco30 * 6;
        const vOther5 = volume12h - vGluco5;

        document.getElementById('arrival-volume-12h').value = `${volume12h.toFixed(2)} ml`;
        document.getElementById('arrival-v-gluco-30').value = `${vGluco30.toFixed(2)} ml`;
        document.getElementById('arrival-v-other-30').value = `${vOther30.toFixed(2)} ml`;
        document.getElementById('arrival-v-gluco-5').value = `${vGluco5.toFixed(2)} ml`;
        document.getElementById('arrival-v-other-5').value = `${vOther5.toFixed(2)} ml`;
    }

    function calculateHospitalFluid() {
        const weight = parseFloat(document.getElementById('weight').value);
        const respFluidLoss = parseFloat(document.getElementById('resp-fluid-loss').value) || 0;
        const digestiveFluidLoss = parseFloat(document.getElementById('digestive-fluid-loss').value) || 0;
        const bodyMass = document.getElementById('body-mass').value;
        
        if (isNaN(weight) || weight <= 0) {
            alert('Vui lòng nhập Trọng lượng hợp lệ.');
            return;
        }

        let bodyWeightForCalculation;
        if (bodyMass === 'normal') {
            bodyWeightForCalculation = weight;
        } else { // 'fat'
            bodyWeightForCalculation = weight * 0.7;
        }

        const totalHospitalFluid = (97 * Math.pow(bodyWeightForCalculation, 0.655)) + respFluidLoss + digestiveFluidLoss;
        
        const vGluco30Arrival = parseFloat(document.getElementById('arrival-v-gluco-30').value);
        if (isNaN(vGluco30Arrival)) {
            alert('Vui lòng tính toán khung "KHI BỆNH THÚ MỚI ĐẾN" trước để có giá trị V Gluco 30% (ml).');
            return;
        }

        const vGluco30Hospital = vGluco30Arrival * 2;
        const vOther30Hospital = totalHospitalFluid - vGluco30Hospital;

        const vGluco5Hospital = vGluco30Hospital * 6;
        const vOther5Hospital = totalHospitalFluid - vGluco5Hospital;

        document.getElementById('hospital-volume-24h').value = `${totalHospitalFluid.toFixed(2)} ml`;
        document.getElementById('hospital-v-gluco-30').value = `${vGluco30Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-other-30').value = `${vOther30Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-gluco-5').value = `${vGluco5Hospital.toFixed(2)} ml`;
        document.getElementById('hospital-v-other-5').value = `${vOther5Hospital.toFixed(2)} ml`;
    }

    function calculateInfusion() {
        const dripFactor = parseFloat(document.getElementById('drip-factor').value);
        const dripRate = parseFloat(document.getElementById('drip-rate').value);
        const volumeToInfuse = parseFloat(document.getElementById('volume-to-infuse').value);
        const startTimeStr = document.getElementById('start-time').value;

        if (isNaN(dripRate) || isNaN(volumeToInfuse) || dripRate <= 0 || volumeToInfuse <= 0) {
            alert('Vui lòng nhập các giá trị Tốc độ nhỏ giọt và Thể tích muốn truyền hợp lệ.');
            return;
        }

        const infusionTimeMinutes = (volumeToInfuse * dripFactor) / dripRate;
        
        const hours = Math.floor(infusionTimeMinutes / 60);
        const minutes = Math.round(infusionTimeMinutes % 60);
        document.getElementById('infusion-time').value = `${hours} giờ ${minutes} phút`;

        if (startTimeStr) {
            const timeParts = startTimeStr.split(':');
            const startHour = parseInt(timeParts[0]);
            const startMinute = parseInt(timeParts[1]);

            if (isNaN(startHour) || isNaN(startMinute) || startHour < 0 || startHour > 23 || startMinute < 0 || startMinute > 59) {
                alert('Định dạng giờ bắt đầu truyền không hợp lệ. Vui lòng nhập theo định dạng HH:MM.');
                document.getElementById('end-time').value = '';
                return;
            }

            const totalMinutes = startHour * 60 + startMinute + infusionTimeMinutes;
            const endHour = Math.floor((totalMinutes / 60) % 24);
            const endMinute = Math.round(totalMinutes % 60);
            
            const endHourStr = endHour.toString().padStart(2, '0');
            const endMinuteStr = endMinute.toString().padStart(2, '0');

            document.getElementById('end-time').value = `${endHourStr}:${endMinuteStr}`;
        }
        
        document.getElementById('start-time-estimation').value = startTimeStr;
    }

    function calculateEstimation() {
        const dripFactor = parseFloat(document.getElementById('drip-factor').value);
        const dripRate = parseFloat(document.getElementById('drip-rate').value);
        const startTimeStr = document.getElementById('start-time').value;
        
        if (!startTimeStr || isNaN(dripRate) || dripRate <= 0) {
            alert('Vui lòng nhập "Giờ bắt đầu truyền:" và "Tốc độ nhỏ giọt" hợp lệ.');
            return;
        }

        const timeParts = startTimeStr.split(':');
        const startHour = parseInt(timeParts[0]);
        const startMinute = parseInt(timeParts[1]);
        
        const now = new Date();
        const currentHour = now.getHours();
        const currentMinute = now.getMinutes();

        const startTotalMinutes = startHour * 60 + startMinute;
        const currentTotalMinutes = currentHour * 60 + currentMinute;
        
        const passedTimeMinutes = currentTotalMinutes - startTotalMinutes;

        if (passedTimeMinutes < 0) {
            alert('Thời gian bắt đầu truyền lớn hơn thời gian hiện tại. Vui lòng kiểm tra lại.');
            document.getElementById('estimated-minutes').value = '';
            document.getElementById('estimated-volume').value = '';
            return;
        }

        const hours = Math.floor(passedTimeMinutes / 60);
        const minutes = passedTimeMinutes % 60;
        
        const estimatedVolume = (dripRate * passedTimeMinutes) / dripFactor;
        
        document.getElementById('estimated-minutes').value = `${hours} giờ ${minutes} phút`;
        document.getElementById('estimated-volume').value = `${estimatedVolume.toFixed(2)} ml`;
    }

// hàm đếm nhỏ giọt
let timer;
    let startTime;
    let drops = 0;
    let isRunning = false;

    function startStopTimer() {
        const timerButton = document.getElementById('timer-button');
        const countButton = document.getElementById('count-button');

        if (!isRunning) {
            startTime = new Date();
            timer = setInterval(updateTime, 1000);
            timerButton.textContent = 'Dừng';
            timerButton.style.backgroundColor = '#dc3545';
            countButton.disabled = false;
            countButton.style.backgroundColor = '#28a745';
            countButton.style.cursor = 'pointer';
            isRunning = true;
        } else {
            clearInterval(timer);
            timerButton.textContent = 'Bắt đầu';
            timerButton.style.backgroundColor = '#007bff';
            countButton.disabled = true;
            countButton.style.backgroundColor = '#6c757d';
            countButton.style.cursor = 'not-allowed';
            isRunning = false;
        }
    }

    function updateTime() {
        const now = new Date();
        const elapsedTime = (now - startTime) / 1000;
        const minutes = Math.floor(elapsedTime / 60).toString().padStart(2, '0');
        const seconds = Math.floor(elapsedTime % 60).toString().padStart(2, '0');
        document.getElementById('elapsed-time').textContent = `${minutes}:${seconds}`;

        // Update drip rate in real-time
        if (elapsedTime > 0) {
            const dripRate = (drops / elapsedTime) * 60;
            document.getElementById('calculated-drip-rate').value = `${dripRate.toFixed(2)} giọt/phút`;
        }
    }

    function countDrop() {
        drops++;
        document.getElementById('drip-count').textContent = drops;
    }

    function resetTimer() {
        clearInterval(timer);
        isRunning = false;
        drops = 0;
        document.getElementById('timer-button').textContent = 'Bắt đầu';
        document.getElementById('timer-button').style.backgroundColor = '#007bff';
        document.getElementById('count-button').disabled = true;
        document.getElementById('count-button').style.backgroundColor = '#6c757d';
        document.getElementById('count-button').style.cursor = 'not-allowed';
        document.getElementById('elapsed-time').textContent = '00:00';
        document.getElementById('drip-count').textContent = '0';
        document.getElementById('calculated-drip-rate').value = '';
    }

    function calculatePredeterminedDripRate() {
        const volume = parseFloat(document.getElementById('volume-predetermined').value);
        const time = parseFloat(document.getElementById('time-predetermined').value);
        const dripFactor = parseFloat(document.getElementById('drip-factor-predetermined').value);

        if (isNaN(volume) || isNaN(time) || volume <= 0 || time <= 0) {
            alert('Vui lòng nhập Thể tích và Thời gian truyền hợp lệ.');
            return;
        }

        const dripRate = (volume * dripFactor) / time;
        document.getElementById('result-drip-rate').value = `${dripRate.toFixed(2)} giọt/phút`;
    }
</script>

    </main>


    <div id="footer-placeholder"></div>
    <div id="modals-placeholder"></div>
    <script src="theme/main.js"></script>
</body>
</html>

