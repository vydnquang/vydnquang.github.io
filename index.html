<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√°ch ·∫£nh l·∫≠t trang</title>
    <link rel="stylesheet" href="css/style.css">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Pacifico&display=swap" rel="stylesheet">
</head>
<body>

    <div id="flipbook-container">
        
        <button id="prevBtn">Trang tr∆∞·ªõc</button>
        <button id="nextBtn">Trang sau</button>

<div id="audio-controls">
            <audio id="background-music" loop>
                <source src="data/nhac-docsach.mp3" type="audio/mpeg">
                Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ th·∫ª audio.
            </audio>
            <button id="playPauseBtn">‚ñ∂</button>
            <button id="muteUnmuteBtn">üîá</button>
            <input type="range" id="volumeSlider" min="0" max="100" value="40">
        </div>

<div id="global-marquee-container" class="marquee-container"><span class="marquee-text"></span></div>

        <div id="flipbook">
            <div class="page title-page">
                <h1 class="book-title">NH·ªÆNG PH∆Ø∆†NG TH·ª®C PH·ª§C H·ªíI S·ª®C KH·ªéE THEO T·ª∞ NHI√äN</h1>
                <p class="book-author">T√°c gi·∫£: Nishi Kasuzo<br>D·ªãch gi·∫£: TS. Tr∆∞∆°ng Th·ªã Th·∫£o</br></p>
                <img src="pages/g-border.png" alt="Khung trang tr√≠" class="page-frame">
            </div>

            
            <div class="page" style="background-image:url(pages/page1.jpg);"></div>
            <div class="page" style="background-image:url(pages/page2.jpg);"></div>
            <div class="page" style="background-image:url(pages/page3.jpg);"></div>
            <div class="page" style="background-image:url(pages/page4.jpg);"></div>
            

	    <div class="page title-page final-page">
                <h1 class="book-title">C·∫£m ∆°n b·∫°n ƒë√£ ƒë·ªçc!</h1>
                <p class="book-author">M·ªùi ƒë√≥n ƒë·ªçc c√°c trang ti·∫øp theo v√†o k·ª≥ sau</p>
                <img src="pages/g-border.png" alt="Khung trang tr√≠" class="page-frame">
            </div>

        </div>

    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/turn.min.js"></script>

<script>
        $(document).ready(function() {
            var flipbook = $("#flipbook");
            var globalMarqueeContainer = $('#global-marquee-container');
            var marqueeTextElement = globalMarqueeContainer.find('.marquee-text'); // L·∫•y ph·∫ßn t·ª≠ span
            var marqueeContent = "üìñ M·ªói ng√†y ƒë·ªçc 10 trang s√°ch, ta l√†m gi√†u s·ª©c kh·ªèe cho ch√≠nh m√¨nh! üìö"; // N·ªôi dung marquee chung

            flipbook.turn({
                width: 400,
                height: 600,
                autoCenter: true,
                acceleration: true,
                display: 'single',
                elevation: 50
            });

            
// H√†m ƒë·ªÉ c·∫≠p nh·∫≠t hi·ªÉn th·ªã d√≤ng ch·ªØ ch·∫°y
            function updateMarqueeVisibility(pageNumber) {
                // Trang ti√™u ƒë·ªÅ ƒë·∫ßu ti√™n l√† 1, trang c·∫£m ∆°n l√† 6.
                // C√°c trang n·ªôi dung l√† 2, 3, 4, 5
                if (pageNumber >= 2 && pageNumber <= 5) { // ƒêi·ªÅu ch·ªânh s·ªë trang t√πy theo t·ªïng s·ªë trang n·ªôi dung c·ªßa b·∫°n
                    marqueeTextElement.text(marqueeContent); // ƒê·∫∑t n·ªôi dung ch·ªØ
                    globalMarqueeContainer.show(); // Hi·ªÉn th·ªã container
                    // KH√îNG c·∫ßn reset animation ·ªü ƒë√¢y n·ªØa v√¨ n√≥ n·∫±m ngo√†i #flipbook
                } else {
                    globalMarqueeContainer.hide(); // ·∫®n container
                    marqueeTextElement.text(''); // X√≥a n·ªôi dung ƒë·ªÉ d·ª´ng animation khi ·∫©n
                }
            }

            // G·ªçi h√†m khi trang s√°ch ƒë∆∞·ª£c l·∫≠t
            flipbook.bind('turned', function(event, page, view) {
                updateMarqueeVisibility(page);
            });

            // G·ªçi h√†m khi s√°ch ƒë∆∞·ª£c t·∫£i l·∫ßn ƒë·∫ßu ƒë·ªÉ ki·ªÉm tra trang hi·ªán t·∫°i
            updateMarqueeVisibility(flipbook.turn('page'));


            $('#nextBtn').click(function() {
                $("#flipbook").turn('next');
            });

            $('#prevBtn').click(function() {
                $("#flipbook").turn('previous');
            });

            $(document).keydown(function(e){
                var flipbook = $("#flipbook");
                if (e.keyCode == 37){ // M≈©i t√™n tr√°i
                    flipbook.turn('previous');
                } else if (e.keyCode == 39){ // M≈©i t√™n ph·∫£i
                    flipbook.turn('next');
                }
            });



// --- Javascript cho ph·∫ßn ƒëi·ªÅu khi·ªÉn nh·∫°c ---
            const backgroundMusic = document.getElementById('background-music');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const muteUnmuteBtn = document.getElementById('muteUnmuteBtn');
            const volumeSlider = document.getElementById('volumeSlider');

            // ƒê·∫∑t √¢m l∆∞·ª£ng ban ƒë·∫ßu 20%
            backgroundMusic.volume = 0.2; 
            volumeSlider.value = 40; // C·∫≠p nh·∫≠t thanh tr∆∞·ª£t

            // S·ª± ki·ªán n√∫t Play/Pause
            playPauseBtn.addEventListener('click', () => {
                if (backgroundMusic.paused) {
                    backgroundMusic.play();
                    playPauseBtn.textContent = '‚è∏';
                } else {
                    backgroundMusic.pause();
                    playPauseBtn.textContent = '‚ñ∂';
                }
            });

            // S·ª± ki·ªán n√∫t T·∫Øt/B·∫≠t ti·∫øng
            muteUnmuteBtn.addEventListener('click', () => {
                if (backgroundMusic.muted) {
                    backgroundMusic.muted = false;
                    muteUnmuteBtn.textContent = 'üîá';
                    volumeSlider.value = backgroundMusic.volume * 100; // ƒê·∫∑t l·∫°i thanh tr∆∞·ª£t v·ªÅ √¢m l∆∞·ª£ng hi·ªán t·∫°i
                } else {
                    backgroundMusic.muted = true;
                    muteUnmuteBtn.textContent = 'üîä';
                    volumeSlider.value = 0; // ƒê·∫∑t thanh tr∆∞·ª£t v·ªÅ 0 khi t·∫Øt ti·∫øng
                }
            });

            // S·ª± ki·ªán thanh tr∆∞·ª£t √¢m l∆∞·ª£ng
            volumeSlider.addEventListener('input', () => {
                backgroundMusic.volume = volumeSlider.value / 100;
                // N·∫øu ƒëang t·∫Øt ti·∫øng m√† ng∆∞·ªùi d√πng ch·ªânh √¢m l∆∞·ª£ng, th√¨ b·∫≠t ti·∫øng l·∫°i
                if (backgroundMusic.muted && backgroundMusic.volume > 0) {
                    backgroundMusic.muted = false;
                    muteUnmuteBtn.textContent = 'üîá';
                } else if (backgroundMusic.volume === 0) {
                    backgroundMusic.muted = true;
                    muteUnmuteBtn.textContent = 'üîä';
                }
            });

            // T·ª± ƒë·ªông ph√°t nh·∫°c khi t·∫£i trang (c√≥ th·ªÉ b·ªã ch·∫∑n b·ªüi tr√¨nh duy·ªát, t·ªët nh·∫•t n√™n click)
            // backgroundMusic.play().catch(error => {
            //     console.log("T·ª± ƒë·ªông ph√°t nh·∫°c b·ªã ch·∫∑n:", error);
            //     // C√≥ th·ªÉ th√¥ng b√°o cho ng∆∞·ªùi d√πng click n√∫t play
            // });


        });
    </script>

</body>
</html>
